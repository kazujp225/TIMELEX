# TIMREXPLUS 要件定義書
## スタッフA/B対応・即時確定型オンライン予約システム

**プロジェクト名**: TIMREXPLUS
**バージョン**: 2.3
**作成日**: 2025年
**対象組織**: ZettAI
**文書種別**: 要件定義書（ビジネス要件）

> 📖 **ドキュメントナビゲーション**: このドキュメントはプロジェクトの要件定義書です。プロジェクト全体の構成や他のドキュメントについては [Claude.md](./Claude.md) を参照してください。

---

## 📋 目次

### 第1部：プロジェクト概要
1. [エグゼクティブサマリー](#1-エグゼクティブサマリー)
2. [プロジェクト概要](#2-プロジェクト概要)
3. [用語定義](#3-用語定義)

### 第2部：体験設計
4. [目指すユーザー体験](#4-目指すユーザー体験)
5. [ユーザーストーリー](#5-ユーザーストーリー)
6. [UI/UX要件](#6-uiux要件)

### 第3部：機能要件
7. [機能要件](#7-機能要件)

### 第4部：品質・技術要件
8. [非機能要件](#8-非機能要件)
9. [外部連携要件](#9-外部連携要件)

### 第5部：運用・評価
10. [運用要件](#10-運用要件)
11. [受け入れ基準](#11-受け入れ基準)
12. [成功指標（KPI）](#12-成功指標kpi)

### 第6部：リスク・計画
13. [制約事項とリスク](#13-制約事項とリスク)
14. [MVP範囲と将来拡張](#14-mvp範囲と将来拡張)
15. [プロジェクト実施ガイドライン](#15-プロジェクト実施ガイドライン)

### 付録
- [付録A：相談種別テンプレート例](#付録a相談種別テンプレート例)
- [付録B：お問い合わせ元の選択肢例](#付録bお問い合わせ元の選択肢例)
- [付録C：通知メール件名例](#付録c通知メール件名例)

---

## 1. エグゼクティブサマリー

### 1.1 何を作るのか

**TimeRex/Calendlyのような直感的な予約体験を、社内運用に最適化したオンライン予約システム**

クライアントが予約URLをクリックし、空き枠を選び、その場で予約を確定。Google Meetリンクが自動発行され、通知まで完結する。待ち時間ゼロ、往復のやり取りゼロ。

### 1.2 なぜ作るのか

**現状の課題**
- 日程調整にメールで2〜3往復、機会損失が発生
- スタッフA/Bの予定確認に手間がかかる
- 予約経路が不明で、マーケティング効果が測定できない
- 継続顧客への適切なフォローができていない

**実現する価値**
- **クライアント**: 3ステップ以内で予約完了、待ち時間ゼロ
- **スタッフ**: 日程調整の手間削減、本質業務に集中
- **経営**: 予約経路の可視化、継続率の向上、コンバージョン最適化

### 1.3 投資対効果

| 指標 | 現状 | 目標 |
|------|------|------|
| 予約確定までの時間 | 1〜2日 | 3分以内 |
| 日程調整往復回数 | 2〜3回 | 0回 |
| 予約完了率 | 推定40% | 60%以上 |
| 継続顧客識別 | 手動 | 自動（30日以内） |

### 1.4 対象読者

| 読者 | 活用目的 |
|------|---------|
| プロダクトオーナー | ビジネス価値の確認、優先順位の判断 |
| 開発チーム | 実装すべき機能の理解、設計の入力 |
| UI/UXデザイナー | 体験設計のガイドライン |
| QAチーム | テスト観点の洗い出し、受け入れ基準の確認 |
| 運用チーム | 初期設定と日常運用の準備 |

---

## 2. プロジェクト概要

### 2.1 プロジェクトの目的

クライアントが予約URLを受け取り、その場で希望日時を選んで即座に予約を確定し、オンライン面談用のGoogle Meetリンクを自動発行・通知する予約システムを構築する。

TimeRexやCalendlyのような直感的な操作体験を提供しながら、社内の予約対応業務を効率化し、顧客の利便性を最大化する。

### 2.2 背景と課題

#### 現状の課題

| 課題分類 | 具体的な問題 | 影響 |
|---------|------------|------|
| **業務効率** | メールやフォームでの日程調整に時間がかかり、往復のやり取りが発生 | スタッフの時間を圧迫 |
| **機会損失** | 予約確定までにタイムラグがあり、その間に失注の可能性 | 売上機会の喪失 |
| **手動作業** | スタッフA/Bの予定を手動で確認・調整 | ヒューマンエラーのリスク |
| **効果測定** | どの媒体・サイトから問い合わせがきたのか追跡が困難 | マーケティングROI不明 |
| **顧客管理** | 継続顧客への対応が新規顧客と混在 | 適切なフォローができない |

#### 実現したい価値

**クライアント視点**
- URLを開いて3ステップ以内に予約完了
- 待ち時間ゼロの体験
- いつでもどこでも、スマホから予約可能

**スタッフ視点**
- 自動調整により日程調整の手間を削減
- 本質的な業務（準備・対応）に集中
- 継続顧客を即座に識別し、質の高いフォローを提供

**経営視点**
- 予約経路の可視化とROI測定
- 継続顧客の識別と継続率向上
- コンバージョン率の最適化

### 2.3 システムの位置づけ

既存のマーケティング・営業フロー（メール配信、LP、チャット等）に自然に接続し、**予約確定〜オンライン面談開始**までを一気通貫でサポートする。

```
[マーケティング施策] → [予約URL] → [即時確定] → [自動通知] → [面談実施]
      ↓
   UTM追跡・効果測定
```

---

## 3. 用語定義

### 3.1 システム用語

| 用語 | 定義 | 備考 |
|------|------|------|
| **予約URL** | クライアントがアクセスする公開ページ。単一URLでスタッフA/Bの統合された空き枠を表示 | 媒体ごとにUTMパラメータを付与 |
| **即時確定** | 空き枠を選択→情報入力→確定ボタンで、仮押さえを挟まずに予約が完了する仕組み | リアルタイム在庫管理が前提 |
| **人手調整モード** | 候補日時を送信し、スタッフが後日メールで確定する運用モード | 複雑な商談・見積等で使用 |
| **スタッフ** | 面談を担当するZettAI社内メンバー | 初期はA/B 2名、将来N名まで拡張 |

### 3.2 業務用語

| 用語 | 定義 | 備考 |
|------|------|------|
| **お問い合わせ元** | クライアントがどの媒体・サイトから予約に至ったかを示す区分 | コーポレートサイト、製品LP、広告、紹介等 |
| **相談種別** | 面談の目的・種類 | 初回相談、デモ、見積、契約前最終確認等 |
| **継続顧客（Recent）** | 過去30日以内に予約・対応履歴がある同一メールアドレスのクライアント | 自動判定、バッジ表示 |
| **可用性** | スタッフが予約を受け付け可能な時間帯 | 勤務時間・休暇・既存予定を考慮 |

### 3.3 技術用語

| 用語 | 定義 | 備考 |
|------|------|------|
| **バッファ** | 面談の前後に確保する余裕時間 | 準備・休憩・移動等のため |
| **最短予約猶予** | 予約可能な最も近い時刻 | 例：開始2時間前まで予約可能 |
| **最長予約期間** | 予約可能な最も先の日付 | 例：60日先まで予約可能 |
| **UTMパラメータ** | マーケティング効果測定用のURLパラメータ | utm_source, utm_medium, utm_campaign |

---

## 4. 目指すユーザー体験

### 4.1 デザインの基本方針

**原則**: 説明不要で直感的に操作できるインターフェース

**設計指針**:
- 各ステップで次のアクションが明確
- 入力項目は最小限（必須項目のみ先頭表示）
- 操作結果の即座なフィードバック
- エラーは発生箇所に隣接して表示

### 4.2 クライアント体験の全体フロー

#### ステップ1：URLを開く
**シーン**: メールやLPから予約リンクをクリック
**第一印象**: 「これは簡単そうだ」と3秒で認識させる

#### ステップ2：日時を選ぶ
**操作**: カレンダーから空いている枠を直感的に選択
**体験**: 一切のストレスなく、タップするだけ

#### ステップ3：情報を入力
**入力項目**: 氏名・メール・お問い合わせ元・相談種別（最小限）
**体験**: 記入ストレスを最小化、確定感を高める

#### ステップ4：即座に確定
**結果**: その場で予約が完了、Google Meetリンクが表示
**体験**: 安心 + 達成感 + 次の行動導線

#### ステップ5：通知を受け取る
**内容**: 確定メールとカレンダー招待が自動で届く
**体験**: 「ちゃんと予約できた」という安心感

### 4.3 スタッフ体験のゴール

| フェーズ | 体験内容 | 目指す状態 |
|---------|---------|-----------|
| **朝** | ダッシュボードで今日の予約を一覧確認 | 1日の流れを把握 |
| **予約時** | 即座にメール通知、詳細をダッシュボードで確認 | 事前準備に集中できる |
| **面談中** | 日程調整の心配なく、対応に専念 | 質の高い面談を提供 |
| **継続対応** | Recentバッジで過去対応を即座に把握 | 一貫性のあるフォロー |

### 4.4 管理者体験のゴール

| 業務 | 頻度 | 実現する価値 |
|------|------|-------------|
| **予約状況の俯瞰** | 毎日 | 今日・今週の予約を一目で把握 |
| **効果測定** | 週次 | お問い合わせ元別の予約数、コンバージョン率を確認 |
| **柔軟な設定** | 随時 | 相談種別、スタッフ稼働時間、通知テンプレート等を管理 |
| **データ活用** | 月次 | CSV出力でレポート作成、経営判断に活用 |

---

## 5. ユーザーストーリー

### 5.1 クライアント（予約者）

#### US-01：シンプルな予約（優先度：最高）

> **As a** クライアント
> **I want to** 予約URLにアクセスし、希望日時を選び、最小限の情報を入力するだけでその場で予約を確定したい
> **So that** 何度もメールをやり取りする時間を省き、すぐに予定を確保できる

**受け入れ基準**:
- 予約URLから3ステップ以内で確定
- 入力項目は6つ以内
- 確定後3秒以内に完了画面表示

#### US-02：即座のフィードバック（優先度：最高）

> **As a** クライアント
> **I want to** 予約完了と同時にGoogle Meetリンクを受け取り、カレンダーに追加できるようにしたい
> **So that** 後で探す手間を省き、当日スムーズに参加できる

**受け入れ基準**:
- 完了画面にMeetリンク表示
- カレンダー追加ボタン表示
- 5秒以内に確定メール送信

#### US-03：柔軟な変更・キャンセル（優先度：高）

> **As a** クライアント
> **I want to** 予定変更が必要な場合、予約メール内のリンクから簡単に変更・キャンセルしたい
> **So that** 再度フォームを探したり、メールで依頼する手間を省ける

**受け入れ基準**:
- メール内のリンクからワンクリックでアクセス
- 変更：新しい日時を選択し直し
- キャンセル：確認画面で即座に取り消し

### 5.2 スタッフ（担当者A/B）

#### US-11：稼働管理の自動化（優先度：最高）

> **As a** スタッフ
> **I want to** 自分の勤務時間・休暇・既存のGoogleカレンダー予定を連携し、空き枠を自動表示したい
> **So that** 手動で空き時間を伝える手間を省き、ダブルブッキングを防げる

**受け入れ基準**:
- Googleカレンダーの予定を自動反映
- 休暇設定が即座に反映
- ダブルブッキングが発生しない

#### US-12：プライバシー保護（優先度：高）

> **As a** スタッフ
> **I want to** Googleカレンダーの既存予定のタイトルや詳細を公開せずに、空き/埋まりのステータスだけを反映したい
> **So that** 他の業務やプライベートの予定を守れる

**受け入れ基準**:
- タイトル・詳細は取得しない
- Busy/Freeのステータスのみ参照
- 設定画面で確認可能

#### US-13：タイムリーな通知（優先度：最高）

> **As a** スタッフ
> **I want to** 予約が入ると即座にメール通知を受け取り、お問い合わせ元・相談種別・顧客情報をすぐに確認したい
> **So that** 事前準備をしっかり行い、質の高い面談を提供できる

**受け入れ基準**:
- 予約確定後5秒以内に通知
- 件名に[お問い合わせ元][相談種別]を含む
- ダッシュボードへのリンク付き

#### US-14：継続顧客の識別（優先度：中）

> **As a** スタッフ
> **I want to** 過去に対応したクライアントが再度予約した場合、自動的に「継続（Recent）」と表示されたい
> **So that** 前回の対応内容を思い出し、一貫性のあるフォローを提供できる

**受け入れ基準**:
- 30日以内の再予約を自動判定
- ダッシュボードにRecentバッジ表示
- 通知件名に[継続]タグ（設定可能）

### 5.3 管理者（ZettAI）

#### US-21：統合管理（優先度：高）

> **As a** 管理者
> **I want to** スタッフA/Bの可用性（営業時間、所要時間、バッファ、最短/最長予約猶予）を一元管理したい
> **So that** 運用ルールを統一し、スタッフごとのばらつきを防げる

**受け入れ基準**:
- 管理画面で一元設定
- 設定変更が即座に反映
- 設定内容のエクスポート可能

#### US-22：効果測定（優先度：高）

> **As a** 管理者
> **I want to** お問い合わせ元別の予約数・継続率・コンバージョン率を確認したい
> **So that** マーケティング施策の効果を測定し、改善につなげられる

**受け入れ基準**:
- お問い合わせ元別の集計
- 期間指定でのレポート
- CSV出力可能

#### US-23：ブランド体験の統一（優先度：中）

> **As a** 管理者
> **I want to** 予約ページのロゴ・色・文言を設定し、ブランドイメージを統一したい
> **So that** 複数の媒体から流入しても一貫した体験を提供できる

**受け入れ基準**:
- ロゴ画像のアップロード
- メインカラー・アクセントカラーの設定
- プレビュー機能

#### US-24：データ活用（優先度：中）

> **As a** 管理者
> **I want to** 予約一覧をCSVエクスポートし、外部ツールで分析したい
> **So that** 詳細なレポートを作成し、経営判断に活用できる

**受け入れ基準**:
- 全項目のCSVエクスポート
- フィルタ条件の保存
- UTF-8エンコーディング

---

## 6. UI/UX要件

### 6.1 デザインシステム

#### カラーパレット

| 用途 | カラー | 値 | 使用例 |
|------|--------|-----|--------|
| **背景** | 完全ホワイト | `#FFFFFF` | ページ背景 |
| **メインカラー** | 優しい青 | `#6EC5FF` | ロゴ、強調、リンク |
| **アクセント** | サンセットイエロー | `#FFC870` | CTA、選択状態 |
| **テキスト（濃）** | 濃灰 | `#2D2D2D` | 見出し、本文 |
| **テキスト（淡）** | グレー | `#666666` | サブテキスト |
| **エラー** | ピンクレッド | `#FF7676` | エラーメッセージ |
| **成功** | グリーン | `#4CAF50` | 成功メッセージ |

#### タイポグラフィ

| 用途 | フォント | サイズ | スタイル |
|------|---------|--------|---------|
| **H1（見出し）** | Noto Sans JP Bold | 24px | letter-spacing: 0.02em |
| **H2（サブ見出し）** | Noto Sans JP Medium | 18px | color: #333 |
| **本文** | Noto Sans JP Regular | 16px | line-height: 1.7 |
| **補足** | Noto Sans JP Regular | 14px | color: #666 |
| **数字** | Inter Regular | 16px | 時刻・日付表示 |

#### レイアウト原則

| 原則 | 指定 |
|------|------|
| **モバイルファースト** | 1列構成、タップ範囲44px以上 |
| **コンテンツ幅** | 最大680px、センター寄せ |
| **セクション間マージン** | 64px（モバイル48px） |
| **角丸** | 8〜16px統一 |
| **シャドウ** | `0 4px 8px rgba(0,0,0,0.06)` |

#### モバイルレイアウト制約

**目的**: 縦長すぎるUI、大きすぎるコンポーネントを防ぎ、快適なモバイル体験を実現する

##### 1. ビューポート単位の活用

| 単位 | 意味 | 使用箇所 |
|------|------|---------|
| **vh (viewport height)** | ビューポートの高さの1% | ページ全体の高さ制御 |
| **dvh (dynamic vh)** | アドレスバー等を考慮した動的な高さ | モバイル推奨（iOS Safari対応） |
| **svh (small vh)** | アドレスバー表示時の高さ | 最小高さの計算 |
| **lvh (large vh)** | アドレスバー非表示時の高さ | 最大高さの計算 |

**推奨**: `height: 100dvh` または `min-height: 100svh; max-height: 100lvh`

##### 2. 画面高さの制約

| 制約 | 指定 | 理由 |
|------|------|------|
| **1画面の最大高さ** | 100vh（100dvh推奨） | スクロールなしで全体が見える |
| **1セクションの最大高さ** | 80vh | 縦長すぎるコンテンツを防ぐ |
| **カード/モーダルの最大高さ** | 90vh | 画面を圧迫しない |
| **リスト/スクロールエリアの最大高さ** | 60vh | 無限スクロールを防ぐ |

##### 3. スクロール設計

| 画面 | スクロール方針 | 最大スクロール量 |
|------|--------------|----------------|
| **トップ画面** | 縦スクロール（カレンダー） | 2〜3画面分（200vh） |
| **入力画面** | 最小限（キーボード表示を考慮） | 1.5画面分（150vh） |
| **完了画面** | スクロール不要 | 1画面以内（100vh） |

**実装**:
- `overflow-y: auto` でスクロール可能に
- `scroll-snap-type: y mandatory` で1画面ずつスナップ（カレンダー）
- `-webkit-overflow-scrolling: touch` でスムーズスクロール（iOS）

##### 4. コンポーネントサイズの上限

| コンポーネント | 最大幅 | 最大高さ | 備考 |
|--------------|--------|---------|------|
| **ボタン** | 100%（親要素） | 56px | タップ範囲は最低44px |
| **入力フィールド** | 100%（親要素） | 48px | 1行テキスト |
| **テキストエリア** | 100%（親要素） | 120px（5行） | メモ欄 |
| **カード** | 100%（親要素） | 80vh | スクロール可能領域内 |
| **画像/ロゴ** | 200px | 50px | ヘッダー用 |
| **モーダル** | 92vw | 90vh | 画面端に余白 |

##### 5. タップ領域の設計

| 要素 | 最小サイズ | 推奨サイズ | 実装 |
|------|----------|----------|------|
| **ボタン** | 44px × 44px | 48px × 48px | `min-height: 44px; min-width: 44px` |
| **アイコンボタン** | 44px × 44px | 48px × 48px | paddingで領域を確保 |
| **リンク** | 44px高さ | 48px高さ | `line-height` + `padding` で確保 |
| **チェックボックス/ラジオ** | 44px × 44px | 48px × 48px | labelで領域を拡張 |

**実装例**:
```css
.button {
  min-height: 44px;
  padding: 12px 24px;
  /* タップ領域を視覚的に示す */
  outline: 2px solid transparent;
}

.button:focus-visible {
  outline: 2px solid #6EC5FF;
}
```

##### 6. キーボード表示時の対応

| 制約 | 指定 | 実装 |
|------|------|------|
| **入力フィールド表示時** | 画面上部1/3に配置 | `scroll-margin-top: 33vh` |
| **送信ボタン** | キーボード上部に固定表示 | `position: sticky; bottom: 0` |
| **フォーム全体高さ** | 最大50vh | キーボード領域を考慮 |

**iOSでのキーボード対応**:
```javascript
// ビューポート高さをリアルタイム取得
window.visualViewport.addEventListener('resize', () => {
  document.documentElement.style.setProperty(
    '--vh',
    `${window.visualViewport.height * 0.01}px`
  );
});
```

##### 7. 禁止事項

| 禁止事項 | 理由 | 代替案 |
|---------|------|--------|
| ❌ `height: 200vh` | 縦長すぎる | `max-height: 100vh; overflow-y: auto` |
| ❌ `position: fixed` の乱用 | スクロール阻害 | `position: sticky` を優先 |
| ❌ 1画面に10個以上の入力項目 | 離脱率上昇 | 複数ステップに分割 |
| ❌ 画像の `width: 100vw` | はみ出し | `max-width: 100%; height: auto` |
| ❌ スクロール禁止 `overflow: hidden` | UX悪化 | 必要最小限に留める |

##### 8. レスポンシブブレークポイント

| デバイス | 幅 | 高さ考慮 | 特記事項 |
|---------|----|---------|---------|
| **スマートフォン（縦）** | 〜767px | 667px〜932px | 主要ターゲット |
| **スマートフォン（横）** | 768px〜 | 375px〜428px | 入力時に横向き対応 |
| **タブレット（縦）** | 768px〜1023px | 1024px〜1366px | カード2列表示可 |
| **デスクトップ** | 1024px〜 | - | 3カラムレイアウト |

**メディアクエリ例**:
```css
/* スマートフォン縦（デフォルト） */
.container {
  max-height: 100dvh;
}

/* スマートフォン横 */
@media (max-height: 500px) and (orientation: landscape) {
  .container {
    max-height: none; /* スクロール許可 */
  }
  .header {
    height: 48px; /* ヘッダーを縮小 */
  }
}

/* タブレット以上 */
@media (min-width: 768px) {
  .calendar-grid {
    grid-template-columns: repeat(2, 1fr); /* 2列表示 */
  }
}
```

##### 9. 各画面の高さ制約（詳細）

| 画面 | 最大高さ | スクロール | 実装 |
|------|---------|----------|------|
| **トップ画面** | 100vh（ファーストビュー） + カレンダー | 縦スクロール | ヘッダー60px + カレンダーエリア |
| **カレンダー画面** | 100vh | 縦スクロール（日付単位） | `scroll-snap-type: y mandatory` |
| **入力画面** | 100vh以内 | キーボード表示時のみスクロール | フィールド間余白最小化 |
| **完了画面** | 100vh以内 | スクロール不要 | 重要情報を画面内に収める |

##### 10. パフォーマンス考慮

| 項目 | 制約 | 理由 |
|------|------|------|
| **画像サイズ** | 最大500KB/枚 | 読込速度 |
| **総ページサイズ** | 初回ロード2MB以下 | モバイル回線対応 |
| **レンダリング** | 60fps維持 | スクロール・アニメーション |
| **再描画** | 最小限 | バッテリー消費抑制 |

### 6.2 画面別UI設計

#### 画面1：トップ画面（URL訪問時）

**構成要素**:
```
┌────────────────────────┐
│ [ロゴ]                  │
│ オンライン面談のご予約    │
│ ～希望の日時を選択～     │
├────────────────────────┤
│ [スタッフA] [スタッフB]  │
├────────────────────────┤
│                         │
│   📅 カレンダー         │
│                         │
└────────────────────────┘
```

**表示要件**:
- ページタイトル：管理画面で設定可能（デフォルト：「オンライン面談のご予約」）
- サブタイトル：1行、20文字以内
- スタッフ情報：名前、写真（任意、48px × 48px円形）
- 初期表示：当日から7日分のカレンダー

**モバイルレイアウト**:
- ヘッダー高さ：60px（ロゴ + タイトル + サブタイトル）
- ファーストビュー：100vh（ヘッダー含む）
- カレンダーエリア：縦スクロール、最大200vh
- スクロールスナップ：日付単位（`scroll-snap-type: y proximity`）
- ヘッダー固定：`position: sticky; top: 0`

#### 画面2：カレンダー画面

**表示仕様**:
- 日付選択：縦スクロール、1日単位で表示
- 空き枠表示：30分単位のボタン、横並び（モバイルは2列）
- 空き状態の表示：
  - 予約可能：青ボタン `#6EC5FF`
  - 予約不可：グレーアウト `#CCCCCC`、テキスト「×」
- 選択時の挙動：
  - 選択した枠を `#FFC870` でハイライト
  - 画面下部に固定バー表示：「○月○日（○）HH:MM〜HH:MM」[次へ]
  - 「次へ」ボタン：幅100%、高さ48px

**モバイルレイアウト**:
- 1日あたりの高さ：最大80vh
- 日付ヘッダー：48px、`position: sticky`
- 時間枠ボタン：48px × 48px（最小タップ領域）、2列グリッド
- 選択バー：固定表示、`position: sticky; bottom: 0`、高さ64px
- スクロール：縦方向のみ、smooth scroll

#### 画面3：入力画面

**構成**:
```
┌────────────────────────┐
│ [1] → [2] → [3]        │ ← ステップバー
├────────────────────────┤
│ お名前 *                │
│ [_______________]       │
│                         │
│ メールアドレス *         │
│ [_______________]       │
│                         │
│ お問い合わせ元 *         │
│ [コーポレート▼]         │
│                         │
│ 相談内容 *              │
│ [初回相談▼]             │
│                         │
│ メモ（任意）            │
│ [_______________]       │
│                         │
│ [この内容で予約を確定する] │
└────────────────────────┘
```

**入力仕様**:
- お名前：テキスト、最大50文字、必須
- メールアドレス：メール形式、最大100文字、必須
- お問い合わせ元：ドロップダウン、必須
- 相談内容：ドロップダウン、必須
- 会社名：テキスト、最大100文字、任意
- メモ：テキストエリア、最大500文字、任意
- 確定ボタン：幅100%、高さ48px、文言「この内容で予約を確定する」

**バリデーション**:
- リアルタイム検証（フォーカスアウト時）
- エラーは各項目の下に赤文字で表示
- メールアドレス形式チェック：正規表現 `^[^\s@]+@[^\s@]+\.[^\s@]+$`

**モバイルレイアウト**:
- 画面全体高さ：最大100vh（キーボード非表示時）
- ステップバー：48px、固定表示
- フォームエリア：スクロール可能、最大50vh
- フィールド間余白：16px（最小化）
- 入力フィールド高さ：48px
- テキストエリア高さ：120px（5行）
- 確定ボタン：`position: sticky; bottom: 0`、高さ56px
- キーボード表示時：自動スクロール、`scroll-margin-top: 33vh`

#### 画面4：完了画面

**構成**:
```
┌────────────────────────┐
│       ✓                │ ← アニメーション
│                         │
│ 予約が確定しました！     │
│                         │
│ 2025/11/14（木）        │
│ 15:00〜15:30            │
│ 担当：スタッフA          │
│                         │
│ [Google Meetに参加]     │ ← 青ボタン
│                         │
│ [カレンダーに追加]       │
│ [予約を変更・キャンセル]  │
└────────────────────────┘
```

**表示内容**:
- チェックマークアイコン：SVGアニメーション（0.8秒）
- 予約日時：大きく表示（フォント20px）
- 担当スタッフ名
- Google Meetリンク：青ボタン、別タブで開く
- カレンダー追加ボタン：.icsファイルダウンロード
- 変更・キャンセルリンク：予約固有URLへ遷移

**モバイルレイアウト**:
- 画面全体高さ：100vh以内（スクロール不要）
- チェックマークエリア：120px（アニメーション用）
- メッセージエリア：200px（予約情報表示）
- ボタンエリア：3つのボタン、各48px、余白16px
- 合計高さ：約500px（画面内に収まる）
- レイアウト：縦積み、センター寄せ
- 固定表示：スクロールなし

### 6.3 アニメーション仕様

| 操作 | アニメーション | 時間 | イージング |
|------|--------------|------|----------|
| **ページ遷移** | フェード（opacity: 0 → 1） | 0.3s | ease-in-out |
| **カレンダー選択** | scale: 1.05 → 1 | 0.2s | ease-out |
| **完了チェック** | SVGパス描画 | 0.8s | ease-in-out |
| **ボタンhover** | opacity: 0.9→1、shadow: 0→4px | 0.2s | ease |
| **ボタンクリック** | scale: 0.95 | 0.1s | ease |

### 6.4 トーン&マナー

| シーン | トーン | 表現例 | NG例 |
|--------|--------|--------|------|
| **初回訪問** | 親しみ × 専門感 | 「こんにちは。ご希望の日時をお選びください」 | 「予約システムへようこそ」 |
| **入力中** | 落ち着き × 明快 | 「あと少しで完了です」 | 「入力してください」 |
| **完了** | 安心 × 前向き | 「予約が確定しました！当日は以下のリンクからご参加ください」 | 「予約を受け付けました」 |
| **エラー** | 冷静 × 手助け | 「すでに埋まってしまったようです。別の枠をお選びください」 | 「エラーが発生しました」 |

---

## 7. 機能要件

### 7.1 予約フロー（クライアント側）

#### FR-01：統合空き枠表示【必須】

**要件**: 予約URLは単一URLで、スタッフA/Bの統合された空き枠を表示する。クライアントは担当者を意識せず、希望日時を選択できる。

**仕様**:
- スタッフA/Bの空き枠を統合し、開始時刻の昇順でソート
- 同一時刻に複数スタッフが空いている場合も1枠として表示
- 内部的にはラウンドロビン（交互割当）で自動配分
- 表示範囲：本日 + 設定された最長予約期間（デフォルト：60日先まで）

#### FR-02：3ステップ予約フロー【必須】

**要件**: 予約は以下の最小ステップで完了する

1. **日時選択**: カレンダーから希望日時をクリック
2. **情報入力**: 氏名・メール・お問い合わせ元・相談種別・会社名（任意）・メモ（任意）
3. **即座に確定**: 確認画面を経て、その場で予約完了

**パフォーマンス要件**:
- ステップ1→2の遷移：1秒以内
- ステップ2→3の遷移：3秒以内（Google Calendar API呼び出し含む）
- 予約確定後の完了画面表示：3秒以内

#### FR-03：Google Meet自動発行【必須】

**要件**: 予約確定と同時に、Google Calendar APIを通じてオンライン面談用のGoogle Meetリンクを自動生成し、予約レコードに紐付ける

**実装仕様**:
- Google Calendar API `events.insert` で `conferenceData.createRequest` パラメータを使用
- `conferenceDataVersion: 1` を指定
- Meetリンク生成失敗時の挙動：
  - 予約を確定せず、カレンダーイベントをロールバック
  - クライアントにエラーメッセージ表示：「一時的なエラーが発生しました。もう一度お試しください」
  - 管理者にアラート通知（メール）

#### FR-04：即時通知【必須】

**要件**: 予約確定と同時に、以下の通知を自動送信する

**クライアント向け**:
- 日時・所要時間
- Google Meetリンク
- カレンダー招待（ICS添付またはGoogle招待）
- 変更・キャンセルリンク
- お問い合わせ元・相談種別の確認

**スタッフ向け**:
- 日時・所要時間
- 顧客情報（氏名・メール・会社名・メモ）
- お問い合わせ元・相談種別
- UTM/リファラ情報
- Recentフラグ（該当する場合）
- ダッシュボードへのリンク

**送信タイミング**: 予約確定後5秒以内（目標：3秒以内）

**エラー処理**:
- メール送信失敗時も予約は確定済みとする
- 完了画面に「メール再送」ボタンを表示
- 管理者にアラート通知

#### FR-05：ダブルブッキング防止【必須】

**要件**: 同一時間帯への複数予約を防ぐため、以下の仕組みを実装する

1. 予約確定前にデータベースレベルでロックを取得
2. Googleカレンダーの最新状態を確認（FreeBusy.query）
3. 競合が検出された場合の処理：
   - エラーメッセージ：「申し訳ございません。選択された時間はすでに埋まってしまいました」
   - 代替枠の提示：直近3件の空き枠を自動表示
   - カレンダー画面に自動で戻る

**実装詳細**:
- データベーストランザクション（SERIALIZABLE分離レベル）
- 冪等性キー：`{email}_{start_time}_{staff_id}` のハッシュ値
- ロールバック時は作成したカレンダーイベントを削除
- リトライ処理：ユーザー操作によるリトライのみ（自動リトライなし）

#### FR-06：変更・キャンセル機能【必須】

**要件**: 予約完了メールに含まれる専用リンクから、以下の操作が可能

- **変更**: 別の日時を選択し直し（同一フローで再予約）
- **キャンセル**: 予約を取り消し

**変更・キャンセル期限**:
- デフォルト：開始時刻の2時間前まで
- 管理画面で設定可能（0〜48時間）
- 期限を過ぎた場合のメッセージ：「変更・キャンセル期限を過ぎています。お手数ですが {contact_email} までご連絡ください」

**セキュリティ**:
- 予約リンクに予約ID + ランダムトークン（32文字）を含める
- トークンはデータベースに保存し、検証時に照合
- リンクの有効期限：予約日時の7日後まで

### 7.2 予約モード

#### FR-10：即時確定モード【必須】

**要件**: 相談種別が「即時確定」に設定されている場合、クライアントが選択した時点でその場で予約が確定し、Google Meetが自動発行される

**適用例**: 初回相談（30分）、デモ（45分）など、定型的な面談

#### FR-11：人手調整モード【必須】

**要件**: 相談種別が「人手調整」に設定されている場合、クライアントは候補日時（最大3つ）を送信し、スタッフが後日メールで確定する

**適用例**: 見積・要件詰め（60分）、契約前最終確認など、事前準備が必要な面談

**理由**: 全ての面談を自動化せず、状況に応じて人手の判断を挟むことで、質の高い対応を実現するため

### 7.3 お問い合わせ元の追跡

#### FR-20：お問い合わせ元の選択【必須】

**要件**: 予約フォームに「お問い合わせ元」の必須選択項目を表示する

**初期設定の選択肢**:
- 自社コーポレートサイト
- 製品LP（AI導入支援）
- 製品LP（社員教育）
- 外部メディア
- 紹介
- 広告（Google）
- 広告（Meta）
- その他

**管理**:
- 管理画面で選択肢の追加・編集・削除が可能
- 各選択肢に内部IDを付与（削除後もデータ整合性を保つ）
- 表示順序の変更可能

#### FR-21：UTM/リファラの自動取得【必須】

**要件**: 予約ページアクセス時に、以下の情報を自動取得し保存する

- UTMパラメータ（utm_source, utm_medium, utm_campaign, utm_content, utm_term）
- リファラ（document.referrer）
- ユーザーエージェント
- IPアドレス（匿名化オプション有り）

**データ保存**:
- セッション開始時にlocalStorageまたはCookieに一時保存
- 予約確定時にデータベースに永続化
- 保持期間：予約レコードと同じ（デフォルト180日）

#### FR-22：通知への反映【必須】

**要件**: お問い合わせ元と相談種別は、スタッフ向け通知メールの件名と本文に必ず含める

**件名フォーマット**:
```
[{新規|継続}][{お問い合わせ元}][{相談種別}] {氏名} 様 YYYY/MM/DD HH:MM
```

**件名例**:
- 新規：`[新規][製品LP(AI導入支援)][初回相談] 山田太郎 様 2025/11/14 15:00`
- 継続：`[継続][製品LP(AI導入支援)][見積] 山田太郎 様 2025/11/20 10:00`

### 7.4 継続顧客（Recent）運用

#### FR-30：継続顧客の自動判定【推奨】

**要件**: 同一メールアドレスで過去N日以内に予約・対応履歴がある場合、自動的に「継続（Recent）」フラグを付与する

**設定**:
- デフォルト判定期間：30日
- 管理画面で変更可能（7日〜90日）
- 判定タイミング：予約フォーム送信時

#### FR-31：Recentバッジの表示【推奨】

**要件**: ダッシュボードの予約一覧で、継続顧客には「Recent」バッジを表示する

**表示仕様**:
- バッジ色：`#FFC870`（アクセントカラー）
- テキスト：「継続」
- 位置：顧客名の右隣

#### FR-32：人手調整への自動切替（オプション）【オプション】

**要件**: 相談種別の設定で、継続顧客の場合は自動的に「人手調整モード」に切り替えることができる

**設定項目**（相談種別ごと）:
- 「継続顧客を人手調整に切替」チェックボックス
- デフォルト：OFF

#### FR-33：通知の差別化【推奨】

**要件**: 継続顧客の場合、スタッフ通知の件名に `[継続]` タグを追加できる（設定でON/OFF可能）

**設定**:
- グローバル設定：「継続顧客を件名に表示」チェックボックス
- デフォルト：ON

**件名例**: `[継続][製品LP(AI導入支援)][見積] 山田太郎 様 2025/11/20 10:00`

### 7.5 可用性管理（スタッフ側）

#### FR-40：稼働時間の設定【必須】

**要件**: スタッフごとに、以下を設定できる

**曜日別稼働時間**:
- 各曜日ごとに開始時刻・終了時刻を設定
- デフォルト：月〜金 9:00-18:00、土日は休み
- 30分単位で設定可能
- 複数の時間帯設定可能（例：9:00-12:00、13:00-18:00）

**特別休暇**:
- 日付指定で休みを設定
- 半日休暇の設定可（午前/午後）
- 一括登録機能（CSVインポート）

**その他**:
- タイムゾーン設定（デフォルト：Asia/Tokyo）

#### FR-41：Googleカレンダー連携【必須】

**要件**: スタッフのGoogleカレンダーと連携し、既存予定がある時間帯は自動的に「埋まっている」扱いにする

**連携仕様**:
- Google Calendar API `freebusy.query` を使用
- 確認対象：プライマリカレンダー（設定で複数カレンダー指定可）
- 取得情報：Busy/Freeのステータスのみ（タイトル・詳細は取得しない）
- 更新頻度：空き枠表示時にリアルタイムで確認

**OAuth設定**:
- スコープ：`https://www.googleapis.com/auth/calendar.readonly`
- リフレッシュトークンの保存と自動更新

#### FR-42：バッファ設定【必須】

**要件**: 相談種別ごとに、面談の前後に確保する余裕時間（バッファ）を設定できる

**設定項目**:
- 前バッファ：デフォルト5分（0〜30分）
- 後バッファ：デフォルト5分（0〜30分）
- 5分単位で設定可能

**計算例**:
- 面談時間：30分
- 前バッファ：5分
- 後バッファ：5分
- 実際の確保時間：40分（14:00予約 → カレンダーは13:55〜14:35をブロック）

#### FR-43：最短・最長予約期間【必須】

**要件**: グローバル設定として、以下を設定できる

**最短予約猶予**:
- デフォルト：2時間前まで
- 設定範囲：0〜48時間
- 1時間単位で設定可能
- 例：設定が2時間の場合、現在14:00なら16:00以降の枠のみ表示

**最長予約期間**:
- デフォルト：60日先まで
- 設定範囲：7日〜365日
- 1日単位で設定可能
- 例：設定が60日の場合、本日から60日後までの枠を表示

### 7.6 スタッフ配分

#### FR-50：ラウンドロビン配分（MVP）【必須】

**要件**: 複数の空き枠がある場合、スタッフA/Bを交互に割り当てる

**実装仕様**:
- 同一時刻に複数スタッフが空いている場合、最後に割り当てられたスタッフIDを参照
- 次の割り当ては、別のスタッフを優先
- 初回割り当て時はランダム選択
- スタッフ優先度の設定は不可（完全に平等）

#### FR-51：負荷平準化配分（将来拡張）【将来】

**要件**: 直近N日間の対応件数が少ないスタッフを優先的に割り当てる

**設定項目**（将来実装）:
- 集計期間：7日/14日/30日から選択
- 優先度の重み付け

### 7.7 通知・リマインド

#### FR-60：確定直後の通知【必須】

**要件**: 予約確定直後、クライアントとスタッフの双方に通知メールを送信する

**詳細は5.1 機能要件 FR-04を参照**

#### FR-61：リマインド通知【推奨】

**要件**: 設定に応じて、以下のタイミングで自動リマインドを送信する

**設定項目**:
- 前日リマインド：ON/OFF、送信時刻（デフォルト：前日18:00）
- 当日リマインド：ON/OFF、何時間前（デフォルト：2時間前）
- リマインド対象：クライアントのみ/スタッフのみ/両方（デフォルト：両方）

**リマインドメール内容**:
- 日時・場所（Google Meetリンク）
- 担当スタッフ名
- 変更・キャンセルリンク
- 準備事項（任意、管理画面で設定可能）

#### FR-62：件名規約の統一【必須】

**要件**: 通知メールの件名は、以下の規約に従う

**クライアント向け**:
```
【確定】[{お問い合わせ元}][{相談種別}] YYYY/MM/DD HH:MM (Google Meet)
```
例：`【確定】[製品LP(AI導入支援)][初回相談] 2025/11/14 15:00 (Google Meet)`

**スタッフ向け**:
```
[{新規|継続}][{お問い合わせ元}][{相談種別}] {氏名} 様 YYYY/MM/DD HH:MM
```
例：`[新規][製品LP(AI導入支援)][初回相談] 山田太郎 様 2025/11/14 15:00`

### 7.8 管理機能

#### FR-70：予約一覧【必須】

**要件**: ダッシュボードで、以下の情報を一覧表示する

- 今日の予約
- 今週の予約
- 全予約（検索・フィルタ機能付き）

**フィルタ項目**:
- 担当者（複数選択可）
- 相談種別（複数選択可）
- お問い合わせ元（複数選択可）
- Recentフラグ（継続のみ/新規のみ/すべて）
- ステータス（確定済み/キャンセル済み/すべて）
- 日付範囲（カレンダーで選択）

**ソート機能**:
- 日時（昇順/降順）
- 作成日時（昇順/降順）

**ページネーション**:
- 1ページあたり：20件/50件/100件から選択
- デフォルト：50件

#### FR-71：予約詳細【必須】

**要件**: 個別予約の詳細画面で、以下を表示する

**基本情報**:
- 予約ID（内部管理用）
- ステータス（確定済み/キャンセル済み）
- 作成日時

**顧客情報**:
- 氏名
- メールアドレス
- 会社名（入力されている場合）
- メモ（入力されている場合）
- Recentフラグ

**予約情報**:
- 日時（開始〜終了）
- 所要時間
- 担当スタッフ
- 相談種別
- お問い合わせ元

**オンライン情報**:
- Google Meetリンク
- カレンダーイベントID

**追跡情報**:
- UTMパラメータ（source, medium, campaign, content, term）
- リファラURL
- IPアドレス
- ユーザーエージェント

**操作履歴**:
- 作成日時
- 変更日時（変更がある場合）
- キャンセル日時（キャンセルされた場合）

#### FR-72：スタッフ管理【必須】

**要件**: 管理画面で、以下を管理できる

- スタッフの追加・編集・無効化
- 稼働時間の設定
- 休暇の設定
- Googleカレンダー連携状態の確認

#### FR-73：相談種別テンプレート管理【必須】

**要件**: 相談種別ごとに、以下を設定できる

**設定項目**:
- 名称：最大50文字（例：初回相談、デモ、見積）
- 所要時間：15分〜180分、15分単位（デフォルト：30分）
- 前バッファ：0〜30分、5分単位（デフォルト：5分）
- 後バッファ：0〜30分、5分単位（デフォルト：5分）
- 予約モード：即時確定/人手調整（デフォルト：即時確定）
- Recent時の動作：即時確定維持/人手調整に切替（デフォルト：即時確定維持）
- 表示順序：数値（昇順で表示）
- 有効/無効フラグ

#### FR-74：お問い合わせ元の管理【必須】

**要件**: 管理画面で、予約フォームに表示する「お問い合わせ元」の選択肢を編集できる

**操作**:
- 追加：名称（最大50文字）、表示順序
- 編集：名称、表示順序の変更
- 削除：論理削除（既存データとの整合性を保つ）
- 並び替え：ドラッグ&ドロップ

#### FR-75：ブランディング設定【推奨】

**要件**: 予約ページのデザインをカスタマイズできる

**設定項目**:
- ロゴ画像：PNG/JPG、最大1MB、推奨サイズ200px × 50px
- メインカラー：カラーピッカーで選択（デフォルト：`#6EC5FF`）
- アクセントカラー：カラーピッカーで選択（デフォルト：`#FFC870`）
- ページタイトル：最大50文字（デフォルト：「オンライン面談のご予約」）
- ページ説明文：最大200文字（デフォルト：「〜希望の日時を選択〜」）
- プレビュー機能：設定変更を反映した予約ページのプレビュー

#### FR-76：CSVエクスポート【必須】

**要件**: 予約一覧を以下の形式でCSVエクスポートできる

**含まれる項目**:
- 予約ID
- ステータス
- 作成日時
- 予約日時（開始）
- 予約日時（終了）
- 所要時間
- 顧客氏名
- 顧客メールアドレス
- 会社名
- メモ
- 担当スタッフ
- 相談種別
- お問い合わせ元
- Recentフラグ
- UTMパラメータ（source, medium, campaign, content, term）
- リファラURL
- Google Meetリンク

**エクスポート設定**:
- エンコーディング：UTF-8 BOM付き（Excelで開く場合）
- 区切り文字：カンマ
- 改行コード：CRLF
- フィルタ条件の反映：現在の絞り込み条件でエクスポート

### 7.9 エラーハンドリング

#### クライアント側エラー

| エラー種別 | 発生条件 | 表示メッセージ | 対応 |
|-----------|---------|--------------|------|
| **入力値不正** | 必須項目未入力、メール形式不正等 | 「{項目名}を正しく入力してください」 | 該当項目の下に赤文字で表示、フォーカス移動 |
| **枠が埋まっている** | 予約確定時に競合検出 | 「申し訳ございません。選択された時間はすでに埋まってしまいました」 | 代替枠3件を自動表示、カレンダー画面に戻る |
| **変更期限切れ** | 変更・キャンセル期限を過ぎている | 「変更・キャンセル期限を過ぎています。お手数ですが {contact_email} までご連絡ください」 | 問い合わせ先を表示 |
| **予約が見つからない** | 無効な予約IDまたはトークン | 「予約情報が見つかりません。URLをご確認ください」 | トップページへのリンク表示 |
| **ネットワークエラー** | API通信失敗 | 「一時的なエラーが発生しました。もう一度お試しください」 | リトライボタン表示 |

#### スタッフ/管理画面側エラー

| エラー種別 | 発生条件 | 表示メッセージ | 対応 |
|-----------|---------|--------------|------|
| **Google連携エラー** | OAuthトークン失効 | 「Googleカレンダーとの連携が切れています。再連携してください」 | 再連携ボタン表示 |
| **権限不足** | 他スタッフのデータ編集試行 | 「この操作を実行する権限がありません」 | - |
| **データ削除失敗** | 外部キー制約違反等 | 「このデータは使用中のため削除できません」 | 無効化を推奨 |
| **CSVエクスポート失敗** | データ量過多等 | 「エクスポートに失敗しました。期間を絞り込んでお試しください」 | フィルタ条件の調整を促す |

#### システムエラー（内部）

| エラー種別 | 発生条件 | ログ記録 | 通知 |
|-----------|---------|---------|------|
| **データベースエラー** | 接続失敗、クエリエラー | ERROR、スタックトレース、SQL | 管理者にメール、Slackアラート |
| **Google API失敗** | レート制限、認証エラー | ERROR、APIレスポンス | 管理者にメール |
| **メール送信失敗** | SMTPエラー、リジェクト | WARNING、送信先、理由 | 管理者にメール（1日1回まとめて） |
| **予期しないエラー** | 未捕捉例外 | CRITICAL、スタックトレース | 即座にSlackアラート |

---

## 8. 非機能要件

### 8.1 可用性

**目標**: 稼働率99.9%（月間ダウンタイム：最大43分）

**対策**:
- インフラの冗長化（複数AZ配置）
- ヘルスチェック（30秒間隔）
- 自動復旧機構（障害検知後5分以内に復旧）

**メンテナンス**:
- 定期メンテナンス：月1回、深夜2:00〜4:00（事前通知1週間前）
- 緊急メンテナンス：事前通知なしで実施可能

### 8.2 同時予約の整合性

**要件**: 同一時間帯への競合予約を確実に防止するため、以下を実装する

- 在庫ロック機構（悲観ロックまたは分散ロック）
- Googleカレンダーとの整合性チェック
- 冪等性キー（メール+開始時刻+担当ID）による再送耐性

**許容範囲**:
- ダブルブッキング発生率：0%（1件も許容しない）
- 競合検知時の代替枠提示成功率：95%以上

### 8.3 性能

| 指標 | 目標値 | 計測条件 | 許容範囲 |
|------|--------|---------|---------|
| **同時アクセス** | 100ユーザー | 通常時 | 500ユーザーまで対応 |
| **空き枠表示時間** | 1.5秒以内 | 初回ロード時 | 2秒以内 |
| **予約確定レスポンス** | 3秒以内 | Google API含む | 5秒以内 |
| **ダッシュボード読込** | 2秒以内 | 100件表示時 | 3秒以内 |
| **データベースクエリ** | 100ms以内 | 単一クエリ | 200ms以内 |

**負荷テスト基準**:
- ピーク時想定：同時100ユーザー、1時間あたり500予約
- ストレステスト：同時500ユーザーでもエラー率5%以下

### 8.4 セキュリティ

| 項目 | 要件 |
|------|------|
| **認証** | Google OAuth 2.0（スタッフのGoogleカレンダー連携） |
| **個人情報** | 保存時・通信時ともに暗号化（at-rest / in-transit） |
| **管理UI** | 多要素認証（MFA）推奨 |
| **CSRF対策** | 予約フォームにトークン付与、有効期限30分 |
| **XSS対策** | 入力値のエスケープ処理、Content-Security-Policy設定 |
| **SQLインジェクション対策** | パラメータ化クエリ、ORMの使用 |
| **レート制限** | 同一IPから1分間に10リクエストまで |
| **セッション管理** | セッションタイムアウト30分、HTTPSのみ |

**脆弱性診断**:
- 実施頻度：年1回
- 対象：OWASP Top 10

### 8.5 監査・レポート

**要件**: 予約の作成・変更・キャンセルには、以下の情報を含む監査ログを記録する

**ログ項目**:
- ログID（一意）
- 操作者種別（クライアント/スタッフ/システム）
- 操作者識別子（メールアドレスまたはスタッフID）
- 操作内容（作成/変更/キャンセル/閲覧）
- 対象予約ID
- 操作日時（UTC）
- IPアドレス
- ユーザーエージェント
- 操作前の状態（JSON）
- 操作後の状態（JSON）

**保存期間**:
- デフォルト：180日
- 設定可能範囲：30日〜365日

### 8.6 可観測性

**要件**: 以下を監視・アラート対象とする

| 監視項目 | 閾値 | アラート |
|---------|------|---------|
| **API 4xx/5xxエラー率** | >5% | Slack通知 |
| **在庫ロック失敗率** | >1% | メール通知 |
| **Google Calendar API失敗率** | >3% | Slack通知 |
| **通知メール送信失敗率** | >2% | メール通知 |
| **予約完了率** | <50% | 週次レポート |

**監視ツール**:
- APM（Application Performance Monitoring）
- ログ管理（Elasticsearch、CloudWatch Logs等）
- アラート通知（Slack、メール）

**ダッシュボード**:
- リアルタイムメトリクス（予約数、エラー率、レスポンスタイム）
- 日次レポート（自動生成、管理者にメール送信）

### 8.7 アクセシビリティ

**WCAG 2.1レベルAA準拠を目指す**:
- キーボード操作対応（Tab、Enter、Escapeキー）
- フォーカスインジケータの明示
- ARIAラベルの適切な付与（role, aria-label, aria-describedby）
- カラーコントラスト比4.5:1以上（本文）、3:1以上（大きな文字）
- フォントサイズの拡大対応（最大200%まで）
- スクリーンリーダー対応（NVDA、VoiceOver等でテスト）

**多言語対応（将来）**:
- 日本語・英語の切替機能
- タイムゾーン対応

### 8.8 法令遵守

| 項目 | 要件 |
|------|------|
| **個人情報保護** | 個人情報保護法に準拠、プライバシーポリシーの掲示 |
| **データ保持** | 予約データ：180日間（設定可能）、監査ログ：180日間 |
| **削除依頼対応** | 顧客からの削除依頼に7営業日以内に対応 |
| **データエクスポート** | 顧客自身のデータをJSON/CSV形式でエクスポート可能 |
| **Cookie同意** | Cookie使用の同意取得（EU圏外のためGDPR対象外だが推奨） |

---

## 9. 外部連携要件

### 9.1 Google OAuth 2.0

**要件**: スタッフごとにGoogleアカウントと連携し、以下の権限を取得する

**必要なスコープ**:
- `https://www.googleapis.com/auth/calendar` - カレンダーイベントの作成・更新・削除
- `https://www.googleapis.com/auth/calendar.freebusy` - 空き情報の確認

**認可フロー**:
- OAuth 2.0 Authorization Code Flow
- リフレッシュトークンの取得と保存
- トークン有効期限：リフレッシュトークンは無期限（ユーザーが取り消すまで）
- アクセストークン有効期限：1時間（自動更新）

### 9.2 Google Calendar API

**要件**: 以下の操作を実行する

| 操作 | API | 用途 |
|------|-----|------|
| **イベント作成** | Events.insert | 面談イベントの作成（conferenceData付き） |
| **イベント更新** | Events.patch | 面談イベントの変更 |
| **イベント削除** | Events.delete | 面談イベントの削除 |
| **空き確認** | FreeBusy.query | スタッフの空き/埋まり状態の確認 |

**エラーハンドリング**:
- API呼び出し失敗時：最大3回リトライ（exponential backoff: 1秒、2秒、4秒）
- レート制限エラー：一時的にそのスタッフの枠を非表示化
- 認証エラー：スタッフに再連携を促す通知

### 9.3 Google Meet自動発行

**要件**: 予約確定時、`conferenceData.createRequest`パラメータを使用してGoogle Meetリンクを自動生成する

**実装パラメータ**:
```json
{
  "conferenceData": {
    "createRequest": {
      "requestId": "{unique-request-id}",
      "conferenceSolutionKey": {
        "type": "hangoutsMeet"
      }
    }
  },
  "conferenceDataVersion": 1
}
```

### 9.4 リフレッシュトークン管理

**要件**: OAuthリフレッシュトークンを安全に保管し、アクセストークンの自動更新を行う

**保管方法**:
- データベースに暗号化して保存
- 暗号化アルゴリズム：AES-256-GCM
- 暗号化キー：環境変数で管理、定期的にローテーション

**健全性チェック**:
- 実施頻度：1日1回（深夜2:00）
- チェック内容：FreeBusy.queryを実行し、成功/失敗を確認
- 失効検知時：スタッフにメール通知、管理画面にアラート表示

### 9.5 メール送信

**要件**: トランザクションメール送信サービス（SendGrid、AWS SES等）を使用し、以下を送信する

**送信種別**:
- 予約確定通知（クライアント/スタッフ）
- リマインド通知
- 変更通知
- キャンセル通知
- システム通知（管理者向け）

**送信設定**:
- 送信元アドレス：`no-reply@{your-domain}` （DKIM/SPF設定済み）
- 返信先アドレス：設定可能（デフォルト：`support@{your-domain}`）
- テンプレートエンジン：HTML + プレーンテキストのマルチパート
- 配信失敗時：3回リトライ（1分、5分、15分後）

---

## 9.6 データモデル概要

本セクションでは、主要なデータエンティティと保持期間を示す。詳細な設計は別途「データベース設計書」で定義する。

### 予約（Bookings）

| 項目 | データ型 | 必須 | 備考 |
|------|---------|------|------|
| id | UUID | ○ | 主キー |
| status | ENUM | ○ | confirmed / cancelled |
| start_time | TIMESTAMP | ○ | 開始日時（UTC） |
| end_time | TIMESTAMP | ○ | 終了日時（UTC） |
| duration_minutes | INTEGER | ○ | 所要時間 |
| staff_id | UUID | ○ | 外部キー（スタッフ） |
| consultation_type_id | UUID | ○ | 外部キー（相談種別） |
| inquiry_source_id | UUID | ○ | 外部キー（お問い合わせ元） |
| client_name | VARCHAR(50) | ○ | 暗号化 |
| client_email | VARCHAR(100) | ○ | 暗号化、小文字正規化 |
| client_company | VARCHAR(100) | - | 暗号化 |
| client_memo | TEXT(500) | - | 暗号化 |
| is_recent | BOOLEAN | ○ | デフォルト：false |
| google_event_id | VARCHAR(255) | ○ | Googleカレンダーイベ��トID |
| google_meet_link | VARCHAR(500) | ○ | |
| cancel_token | VARCHAR(64) | ○ | ランダム生成、URLに使用 |
| utm_source | VARCHAR(100) | - | |
| utm_medium | VARCHAR(100) | - | |
| utm_campaign | VARCHAR(100) | - | |
| utm_content | VARCHAR(100) | - | |
| utm_term | VARCHAR(100) | - | |
| referrer_url | VARCHAR(500) | - | |
| ip_address | VARCHAR(45) | - | IPv6対応、匿名化オプション |
| user_agent | VARCHAR(500) | - | |
| created_at | TIMESTAMP | ○ | UTC |
| updated_at | TIMESTAMP | ○ | UTC |
| cancelled_at | TIMESTAMP | - | UTC |

**保持期間**: 180日（設定可能：30日〜365日）

### スタッフ（Staff）

| 項目 | データ型 | 必須 | 備考 |
|------|---------|------|------|
| id | UUID | ○ | 主キー |
| name | VARCHAR(50) | ○ | |
| email | VARCHAR(100) | ○ | 一意 |
| photo_url | VARCHAR(500) | - | |
| is_active | BOOLEAN | ○ | デフォルト：true |
| google_refresh_token | TEXT | - | 暗号化 |
| google_token_expires_at | TIMESTAMP | - | |
| timezone | VARCHAR(50) | ○ | デフォルト：Asia/Tokyo |
| created_at | TIMESTAMP | ○ | UTC |
| updated_at | TIMESTAMP | ○ | UTC |

**保持期間**: 無期限（論理削除）

### 相談種別（ConsultationTypes）

| 項目 | データ型 | 必須 | 備考 |
|------|---------|------|------|
| id | UUID | ○ | 主キー |
| name | VARCHAR(50) | ○ | |
| duration_minutes | INTEGER | ○ | 15〜180 |
| buffer_before_minutes | INTEGER | ○ | 0〜30 |
| buffer_after_minutes | INTEGER | ○ | 0〜30 |
| mode | ENUM | ○ | immediate / manual |
| recent_mode_override | ENUM | ○ | keep / switch_to_manual |
| display_order | INTEGER | ○ | |
| is_active | BOOLEAN | ○ | デフォルト：true |
| created_at | TIMESTAMP | ○ | UTC |
| updated_at | TIMESTAMP | ○ | UTC |

**保持期間**: 無期限（論理削除）

### お問い合わせ元（InquirySources）

| 項目 | データ型 | 必須 | 備考 |
|------|---------|------|------|
| id | UUID | ○ | 主キー |
| name | VARCHAR(50) | ○ | |
| display_order | INTEGER | ○ | |
| is_active | BOOLEAN | ○ | デフォルト：true |
| created_at | TIMESTAMP | ○ | UTC |
| updated_at | TIMESTAMP | ○ | UTC |

**保持期間**: 無期限（論理削除）

### 監査ログ（AuditLogs）

| 項目 | データ型 | 必須 | 備考 |
|------|---------|------|------|
| id | UUID | ○ | 主キー |
| actor_type | ENUM | ○ | client / staff / system |
| actor_identifier | VARCHAR(100) | ○ | メールアドレスまたはID |
| action | ENUM | ○ | create / update / cancel / view |
| target_booking_id | UUID | - | 外部キー |
| ip_address | VARCHAR(45) | - | |
| user_agent | VARCHAR(500) | - | |
| state_before | JSONB | - | |
| state_after | JSONB | - | |
| created_at | TIMESTAMP | ○ | UTC |

**保持期間**: 180日（設定可能：30日〜365日）

---

## 10. 運用要件

### 10.1 初期設定フロー

**要件**: システム稼働前に、以下の設定を完了する

| ステップ | 内容 | 確認事項 |
|---------|------|---------|
| **1** | スタッフA/BのGoogle連携 | テストイベント作成・削除まで確認 |
| **2** | 相談種別テンプレート登録 | 初回相談（30分/即時）、デモ（45分/即時）、見積（60分/人手）等 |
| **3** | お問い合わせ元の選択肢登録 | 実運用の媒体名を登録 |
| **4** | メール件名テンプレート確認 | テスト送信で確認 |
| **5** | UTM付与テスト | LP→予約URL経由でUTM情報が正しく保存されるか確認 |

**初期データ準備**:
- 相談種別：最低2種類（即時確定、人手調整）
- お問い合わせ元：最低3種類
- スタッフ：最低1名（A/B推奨）

### 10.2 日常運用

#### スタッフの作業

| タイミング | 作業 | 所要時間 |
|-----------|------|---------|
| **朝** | ダッシュボードで今日の予約を確認 | 2分 |
| **予約通知受信時** | 詳細確認、事前準備 | 5分 |
| **面談後** | 必要に応じてメモを追記 | 3分 |

#### 管理者の作業

| 頻度 | 作業 | 所要時間 |
|------|------|---------|
| **週次** | 予約状況レポートの確認、お問い合わせ元別のコンバージョン率分析 | 30分 |
| **月次** | スタッフの負荷分散状況の確認、相談種別ごとの傾向分析 | 60分 |
| **随時** | スタッフの休暇登録、稼働時間変更、お問い合わせ元の追加・削除 | 5分 |

### 10.3 異常時の対応

#### Google OAuth失効時

**対応フロー**:
1. システムが自動検知
2. 該当スタッフの枠を自動非表示
3. 管理画面にアラート表示
4. スタッフにメール通知し、再連携を促す

#### Google Meet発行失敗時

**対応フロー**:
1. 予約を確定せず、在庫を解放
2. クライアントに「一時的なエラーが発生しました。別の枠をお選びください」と表示
3. 管理者にアラート通知

#### メール不達時

**対応フロー**:
1. 完了画面にGoogle Meetリンクを表示（メール不達でも情報取得可能）
2. 「確認メールを再送」ボタンを提供
3. 管理画面でメール送信ログを確認可能

---

## 11. 受け入れ基準（MVP）

以下の基準を全て満たすことをMVP完成の条件とする。

| ID | 基準 | 確認方法 |
|----|------|---------|
| **AC-01** | 予約URLから3ステップ以内で予約が確定し、完了画面にGoogle Meetリンクが表示される | E2Eテスト |
| **AC-02** | 予約確定後5秒以内に、クライアントとスタッフの双方にメールが届く | タイマー計測 |
| **AC-03** | 同一枠へ同時アクセスした場合、1件のみ確定し、他は「枠が埋まりました」エラーが表示される | 並行テスト |
| **AC-04** | スタッフのGoogleカレンダーでBusyの時間帯は、予約ページに表示されない/選択できない | 手動確認 |
| **AC-05** | 予約メール内のリンクから、ワンクリックで変更・キャンセルが可能 | E2Eテスト |
| **AC-06** | 予約レコードに、表示選択の「お問い合わせ元」とUTM/リファラ情報が両方保存される | DB確認 |
| **AC-07** | スタッフ向け通知の件名に、必ず`[お問い合わせ元][相談種別]`が含まれる | メール確認 |
| **AC-08** | 相談種別が「人手調整」の場合、自動確定せず、内部に「要アサイン」タスクが起票される | 手動確認 |
| **AC-09** | 30日以内に同一メールで再来した場合、自動的にRecent=trueになり、ダッシュボードにバッジが表示される | E2Eテスト |
| **AC-10** | 個人情報（氏名・メール）は、データベース保存時に暗号化されている | セキュリティ監査 |

---

## 12. 成功指標（KPI）

システムの成功を測定するため、以下のKPIを追跡する。

### 12.1 予約完了率

**定義**: 予約ページ訪問者のうち、予約を完了した割合
**目標**: 60%以上
**測定方法**: Google Analytics、内部ログ

**重要性**: コンバージョン率の指標として、UI/UXの改善に活用

### 12.2 予約確定までの時間

**定義**: URLアクセスから予約確定までの平均時間
**目標**: 3分以内
**測定方法**: 内部ログのタイムスタンプ分析

**重要性**: 操作の簡便性を測る指標

### 12.3 No-show率

**定義**: 予約確定後、実際に面談が実施されなかった割合
**目標**: 5%以下
**測定方法**: スタッフによる実施報告

**重要性**: リマインド機能の効果測定

### 12.4 継続率

**定義**: 初回面談後、30日以内に再度予約した顧客の割合
**目標**: 20%以上
**測定方法**: 内部データ分析

**重要性**: サービス価値と顧客満足度の指標

### 12.5 お問い合わせ元別コンバージョン率

**定義**: 各お問い合わせ元からの予約完了率
**目標**: 媒体ごとに設定
**測定方法**: 内部データ分析、UTM追跡

**重要性**: マーケティングROIの測定、施策の改善

### 12.6 スタッフ負荷偏差

**定義**: スタッフ間の対応件数のばらつき
**目標**: 偏差±10%以内
**測定方法**: 内部データ集計

**重要性**: 配分ロジックの適正性を評価

---

## 13. 制約事項とリスク

### 13.1 制約事項

#### 技術的制約

| 制約 | 影響 | 対応 |
|------|------|------|
| Google Workspace連携が前提 | 個人Googleアカウントは非対応の可能性 | 事前に要件確認 |
| Google Calendar APIの利用制限 | 1日あたりの呼び出し回数上限あり | キャッシュ活用、効率的なAPI呼び出し |

#### 運用的制約

| 制約 | 影響 | 対応 |
|------|------|------|
| スタッフは週1回以上、Googleカレンダー更新が必要 | 更新漏れで空き枠が不正確になる | リマインド通知、ヘルスチェック |
| お問い合わせ元の選択肢は手動メンテナンス | 新規媒体の追加に手間がかかる | 管理画面での簡単編集機能 |

### 13.2 リスクと対策

#### リスク1：在庫競合の甘い設計

**リスク**: DBロックとGoogle側の整合性を軽視すると、ダブルブッキングが発生し、体験が一気に崩れる

**影響度**: 高
**発生確率**: 中

**対策**:
- 冪等性キー + トランザクション + ロールバック機構を初期から厳格に実装
- 並行テストで徹底的に検証

#### リスク2：OAuth継続性の疎か

**リスク**: トークン失効を検知できないと、朝いちで全枠が"空いてる風"になり、予約後にエラーが発生して事故る

**影響度**: 高
**発生確率**: 中

**対策**:
- トークン健全性チェックを定期ジョブで実行（1日1回）
- UI表示を必須に（連携状態の可視化）

#### リスク3：URLの乱立

**リスク**: フォーム"送り放題"は良いが、URLが乱立するとブランド体験がばらける

**影響度**: 中
**発生確率**: 高

**対策**:
- イベントタイプとテーマを中央集権管理
- URL発行は管理者権限に制限

#### リスク4：キャンセルポリシー不在

**リスク**: キャンセルポリシーなしは、直前キャンセルが多発しコストが爆増する

**影響度**: 中
**発生確率**: 中

**対策**:
- 最短猶予/キャンセル期限を初期から運用設計に組み込む
- キャンセル率を週次でモニタリング

#### リスク5：お問い合わせ元とUTMの不整合

**リスク**: 選択値とUTMの整合を取らないと、集計が狂う

**影響度**: 低
**発生確率**: 高

**対策**:
- 両方保存し、後で突合する仕組みを導入
- 月次レポートで不整合をチェック

---

## 14. MVP範囲と将来拡張

### 14.1 MVP（必須機能）

以下をMVPに含める。

**コア機能**:
- ✅ 予約URL（単一URL）から、スタッフA/Bの統合空き枠を表示
- ✅ 即時確定モードと人手調整モードの両対応
- ✅ Google Calendar連携（Events.insert/patch/delete、Busy確認）
- ✅ Google Meet自動発行
- ✅ 通知メール送信（クライアント/スタッフ）

**追跡・分析**:
- ✅ お問い合わせ元の選択 + UTM/リファラ自動取得
- ✅ 相談種別テンプレート管理
- ✅ 継続顧客（Recent）の自動判定・バッジ表示

**運用機能**:
- ✅ 変更・キャンセル機能
- ✅ ダブルブッキング防止機構
- ✅ ダッシュボード（予約一覧・検索・フィルタ・CSV出力）
- ✅ スタッフ管理（稼働時間・休暇・Google連携状態）
- ✅ シンプルなラウンドロビン配分

### 14.2 将来拡張（次フェーズ）

#### フェーズ2：エンゲージメント強化

**目標**: リマインド・通知強化で No-show 率を下げる

- 📧 事前アンケート機能（カスタム項目・条件分岐）
- 🔗 Webhook連携（予約確定時に外部システムへ通知）
- 💬 Slack/LINE通知
- 📱 リマインドSMS送信

**期間**: 3ヶ月

#### フェーズ3：マネタイゼーション・分析

**目標**: 有料面談対応、詳細な効果測定

- 💳 決済連携（有料面談の事前決済）
- 🧪 ABテスト機能（複数の予約ページを比較）
- 📊 コンバージョン計測・UTM引継ぎの詳細分析
- 🔔 No-show対策（二重通知、再予約誘導）

**期間**: 3ヶ月

#### フェーズ4：スケール・グローバル

**目標**: 多言語・多スタッフ対応

- 🌐 多言語対応（英語・中国語等）
- 🎨 ブランド別テーマ（複数企業・事業部での運用）
- 👥 スタッフN名対応（3名以上）
- ⚖️ 負荷平準化配分ロジック

**期間**: 6ヶ月

---

## 15. プロジェクト実施ガイドライン

### 15.1 段階的なリリース

**推奨アプローチ**:

| フェーズ | 内容 | 期間 |
|---------|------|------|
| **Phase 1** | 即時確定モードのみ、スタッフA/B対応、基本通知 | 2ヶ月 |
| **Phase 2** | 人手調整モード、お問い合わせ元追跡、Recent機能追加 | 1ヶ月 |
| **Phase 3** | ダッシュボード拡充、CSV出力、詳細フィルタ | 1ヶ月 |

**理由**: 早期にフィードバックを得て、要件の精度を高めるため

### 15.2 ユーザーテスト

**実施タイミング**: 各フェーズのリリース前

**テスト内容**:

| テスト種別 | 内容 | 実施者 |
|-----------|------|--------|
| **E2Eテスト** | 予約→通知→変更→キャンセル | QAチーム |
| **通知確認** | メール件名・本文の確認 | スタッフ |
| **ダッシュボード操作** | 一覧・検索・フィルタの操作性確認 | 管理者 |
| **競合テスト** | 同時予約でのダブルブッキング確認 | QAチーム |

**理由**: 実運用での問題を事前に発見し、品質を担保するため

### 15.3 ドキュメント整備

**必要なドキュメント**:

| ドキュメント | 対象者 | 内容 |
|------------|-------|------|
| **操作マニュアル** | クライアント | 予約方法、変更・キャンセル方法 |
| **操作マニュアル** | スタッフ | ダッシュボードの使い方、設定方法 |
| **操作マニュアル** | 管理者 | 全機能の使い方、初期設定手順 |
| **トラブルシューティングガイド** | 全員 | 異常時の対応手順（OAuth失効、Meet発行失敗等） |
| **設定変更手順書** | 管理者 | 相談種別追加、お問い合わせ元追加等 |

**理由**: 運用の属人化を防ぎ、誰でも対応できる体制を構築するため

### 15.4 継続的改善

**改善サイクル**:

| 頻度 | 内容 | 責任者 |
|------|------|--------|
| **週次** | KPIレポート確認、異常値の分析 | プロダクトオーナー |
| **月次** | ユーザーフィードバックの収集、改善項目の優先順位付け | プロダクトオーナー |
| **四半期** | 大型機能追加の企画・開発 | プロダクトオーナー、開発チーム |

**理由**: 市場やユーザーニーズの変化に対応し、競争力を維持するため

---

## 付録A：相談種別テンプレート例

| 相談種別 | 所要時間 | バッファ（前/後） | モード | Recent時の動作 |
|----------|----------|------------------|--------|----------------|
| 初回相談（AI導入ざっくり） | 30分 | 前5分/後5分 | 即時確定 | 即時確定維持 |
| デモ（具体機能） | 45分 | 前10分/後10分 | 即時確定 | 即時確定維持 |
| 見積・要件詰め | 60分 | 前10分/後10分 | 人手調整 | 人手調整維持 |
| 契約前最終確認 | 30分 | 前5分/後5分 | 人手調整 | 人手調整維持 |

---

## 付録B：お問い合わせ元の選択肢例

- 自社コーポレートサイト
- 製品LP（AI導入支援）
- 製品LP（社員教育プログラム）
- 外部メディアA（○○ニュース）
- 紹介（既存顧客）
- 広告（Google）
- 広告（Meta）
- その他

---

## 付録C：通知メール件名例

### クライアント向け

```
【確定】[製品LP(AI導入支援)][初回相談] 2025/11/14(木) 15:00 (Google Meet)
```

### スタッフ向け（新規）

```
[新規][製品LP(AI導入支援)][初回相談] 山田太郎 様 2025/11/14 15:00
```

### スタッフ向け（継続）

```
[継続][製品LP(AI導入支援)][見積] 山田太郎 様 2025/11/20 10:00
```

---

**文書の最後**

本要件定義書は、ビジネス要件に焦点を当てています。
技術的な実装詳細（データモデル、API設計、アーキテクチャ選定等）は、別途「設計書」として作成することを推奨します。

**更新履歴**:
- **v1.0**: 初版作成
- **v2.0**: 会話形式の内容を統合、技術詳細を削除、言語化を強化
- **v2.1**: 目次追加、エグゼクティブサマリー追加、表形式の改善、視覚的な区切りの強化、優先度ラベルの追加
- **v2.2**: 具体化・詳細化版
  - 抽象的・飛躍した表現を削除（"触りたくなるUI"、"TimeRex × ポケポケ風"等）
  - デフォルト値を全項目に明記（最短予約猶予：2時間、最長予約期間：60日等）
  - バリデーションルールの詳細化（メール形式、文字数制限等）
  - エラーハンドリングセクションを追加（7.9）
  - データモデル概要を追加（9.6）、保持期間を明記
  - 性能要件の具体化（目標値と許容範囲）
  - セキュリティ要件の詳細化（レート制限、暗号化方式等）
  - 外部連携の実装詳細を追加（リトライポリシー、エラーハンドリング等）
- **v2.3**: モバイルレイアウト制約を追加
  - モバイルレイアウト制約セクション新規追加（6.1.1）
    - ビューポート単位（vh, dvh, svh, lvh）の活用方法
    - 画面高さの制約（1画面最大100vh、セクション最大80vh）
    - スクロール設計（画面ごとの最大スクロール量）
    - コンポーネントサイズの上限（ボタン、入力フィールド等）
    - タップ領域の設計（最小44px × 44px）
    - キーボード表示時の対応（iOS対応含む）
    - 禁止事項（縦長すぎるUI、固定要素の乱用等）
    - レスポンシブブレークポイント
  - 各画面のモバイルレイアウト仕様を追加
    - 画面1（トップ）：ヘッダー固定、カレンダースクロール
    - 画面2（カレンダー）：日付単位スナップ、選択バー固定
    - 画面3（入力）：キーボード対応、自動スクロール
    - 画面4（完了）：100vh以内、スクロール不要

---

**以上**
