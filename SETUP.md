# TIMREXPLUS セットアップガイド

## 商材管理機能のセットアップ

### 1. Supabaseマイグレーションの適用

商材管理機能を使用するには、以下のマイグレーションをSupabaseに適用する必要があります。

1. Supabaseのダッシュボード (https://supabase.com) にログイン
2. プロジェクトを選択
3. 左サイドバーから「SQL Editor」を選択
4. 「New query」をクリック
5. 以下のファイルの内容をコピー&ペースト:
   - `supabase/migrations/20251117_add_products.sql`
6. 「Run」ボタンをクリックして実行

### 2. サンプルデータの確認

マイグレーションを実行すると、以下のサンプルデータが自動的に挿入されます:

- **初回相談** (60分, 青色)
  - 質問1: ご相談内容を教えてください (長文テキスト, 必須)
  - 質問2: ご希望の連絡方法を選択してください (ラジオボタン, 必須)
- **フォローアップ相談** (30分, オレンジ色)

### 3. 商材管理画面へのアクセス

1. 管理画面にログイン
2. サイドバーから「商材管理」をクリック
3. 既存の商材が表示されます

### 4. 商材の編集

1. 商材管理ページで「編集」ボタンをクリック
2. 商材情報を変更:
   - 商材名
   - 説明
   - 所要時間
   - カラー
   - 有効/無効
3. フォーム質問を編集:
   - 質問をクリックして展開
   - 質問文、回答形式、選択肢を編集
   - 新しい質問を追加可能
4. 「変更を保存」をクリック

### 5. 新規商材の追加

1. 商材管理ページで「新規商材追加」ボタンをクリック
2. 基本情報を入力
3. 「質問を追加」ボタンで質問を追加
4. 質問タイプを選択:
   - 短文テキスト
   - 長文テキスト
   - ラジオボタン
   - チェックボックス
   - プルダウン
5. 選択式の場合は選択肢を追加
6. 「商材を作成」をクリック

## トラブルシューティング

### 商材が表示されない場合

1. Supabaseマイグレーションが正しく実行されたか確認
2. ブラウザのコンソールでエラーをチェック
3. Supabaseの「Table Editor」で `products` テーブルが存在するか確認

### 編集ボタンが機能しない場合

1. 商材のIDが正しく取得されているか確認
2. `/admin/products/[id]` ページが存在するか確認
3. APIエンドポイント `/api/admin/products/[id]` が正しく動作しているか確認

### 質問が保存されない場合

1. `product_questions` テーブルが存在するか確認
2. 質問タイプが正しい値 (text, textarea, radio, checkbox, select) か確認
3. 選択肢が正しいJSON形式か確認

## 機能一覧

### 実装済み機能

- ✅ 商材の一覧表示
- ✅ 商材の作成
- ✅ 商材の編集
- ✅ 商材の削除
- ✅ フォーム質問の作成・編集
- ✅ 5種類の質問タイプ対応
- ✅ アコーディオンUIで見やすい編集画面
- ✅ 予約フローとの連携
- ✅ 回答データの保存

### 今後の拡張

- 商材の並び替え機能
- 質問のドラッグ&ドロップ並び替え
- 質問の条件分岐
- 回答データの分析・エクスポート
